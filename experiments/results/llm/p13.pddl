The optimal plan to solve the problem is as follows:

1. Unstack b5 from b2
2. Putdown b5
3. Unstack b2 from b3
4. Putdown b2
5. Unstack b3 from b1
6. Putdown b3
7. Unstack b8 from b6
8. Putdown b8
9. Pickup b3
10. Stack b3 on top of b1
11. Pickup b5
12. Stack b5 on top of b3
13. Pickup b4
14. Stack b4 on top of b8
15. Unstack b6 from b9
16. Putdown b6
17. Unstack b4 from b6
18. Putdown b4
19. Unstack b2 from b9
20. Putdown b2
21. Pickup b9
22. Stack b9 on top of b2
23. Pickup b8
24. Stack b8 on top of b7

With this plan, all the blocks will be arranged according to the given goal configuration.